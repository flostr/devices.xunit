<Page
    x:Class="Xunit.Runners.Pages.AssemblyTestListPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Xunit.Runners.Pages"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:runners="using:Xunit.Runners" 
    xmlns:utilities="using:Xunit.Runners.Utilities"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Page.Resources>
        <utilities:RunStatusToColorConverter x:Key="RunStatusToColorConverter" />
        <utilities:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />        
    </Page.Resources>

    <Grid Margin="4" >

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="10" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid Grid.Row="0">
            <TextBlock Text="{Binding DisplayName}" Style="{StaticResource SubheaderTextBlockStyle}" Margin="0,0,100,0"/>
            <Button VerticalAlignment="Stretch" Width="100" Content="Back" HorizontalAlignment="Right" Command="{Binding BackCommand}"/>            
        </Grid>
        <ProgressBar Grid.Row="1" Height="10" IsIndeterminate="True" Visibility="{Binding IsBusy, Converter={StaticResource BoolToVisibilityConverter}, Mode=OneWay}" />
        <Grid Grid.Row="2">
            <TextBox PlaceholderText="filter" Text="{Binding SearchQuery, Mode=TwoWay}" HorizontalAlignment="Stretch" Margin="0,0,100,0" KeyUp="TextBox_KeyUp"/>
            <ComboBox x:Name="resultFilter" Width="100" SelectedIndex="0" SelectionChanged="resultFilter_SelectionChanged" HorizontalAlignment="Right">
                <ComboBoxItem Content="All"/>
                <ComboBoxItem Content="Passed"/>
                <ComboBoxItem Content="Failed"/>
                <ComboBoxItem Content="Skipped"/>
                <ComboBoxItem Content="Not Run"/>
            </ComboBox>
        </Grid>
        <ListView Grid.Row="3"
                  SelectionMode="Single"
            ItemsSource="{Binding TestCases}" SelectionChanged="ListView_SelectionChanged" ScrollViewer.HorizontalScrollBarVisibility="Auto">
            <ListView.ItemTemplate>
                <DataTemplate><!-- EDIT TODO x:DataType="runners:TestCaseViewModel">-->
                    <StackPanel>
                        <TextBlock Text="{Binding DisplayName}" Style="{StaticResource SubtitleTextBlockStyle}"  />
                        <TextBlock Text="{Binding Message, Mode=OneWay}"
                                   Foreground="{Binding RunStatus, Converter={StaticResource RunStatusToColorConverter}, Mode=OneWay}"
                                   Style="{StaticResource BodyTextBlockStyle}"
                                   />
                    </StackPanel>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>
        <StackPanel Grid.Row="4">
            <Button 
                Content="Run Filtered"
                Command="{Binding RunFilteredTestsCommand}"
                />
            <Button x:Name="allButton"
                    Command="{Binding RunAllTestsCommand}"
                    Content="Run All" />
        </StackPanel>
    </Grid>
</Page>
